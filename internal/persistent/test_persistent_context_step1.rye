; Comprehensive test for persistent contexts in Rye
; This test demonstrates persistence, interface compatibility, and various operations

print "=== Persistent Context Comprehensive Test ==="

; Clean up any existing test database
; rm-file "test_pctx_comprehensive.db"

print "\n1. Creating persistent context and setting initial values..."

; Create a new persistent context
pctx: persistent-context "test_pctx_comprehensive.db"

; Test setting different types of values
do\in pctx {
    ; Basic values
    number-val: 42
    string-val: "Hello, Rye!"
    ; Collections
    list-val: [ 1 2 3 "four" ]
    
    ; print "Initial values set in persistent context"
} 

print "\n2. Reopening context to test persistence..."

; Close current context and reopen
pctx2: persistent-context "test_pctx_comprehensive.db"

print pctx/string-val

print pctx2/string-val

